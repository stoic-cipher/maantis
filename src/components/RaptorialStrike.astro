---
interface Props {
  animate?: boolean;
}

const { animate = true } = Astro.props;
---

<div class={`raptorial-container ${animate ? 'animated' : ''}`}>
  <svg viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg" class="raptorial-svg">
    <defs>
      <!-- Gradients for depth -->
      <linearGradient id="appendage-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#00d9ff;stop-opacity:0.8" />
        <stop offset="50%" style="stop-color:#00b4d8;stop-opacity:0.6" />
        <stop offset="100%" style="stop-color:#90e0ef;stop-opacity:0.4" />
      </linearGradient>

      <radialGradient id="impact-gradient" cx="50%" cy="50%">
        <stop offset="0%" style="stop-color:#ffffff;stop-opacity:1" />
        <stop offset="30%" style="stop-color:#00d9ff;stop-opacity:0.8" />
        <stop offset="100%" style="stop-color:#00b4d8;stop-opacity:0" />
      </radialGradient>

      <!-- Filter for glow -->
      <filter id="strike-glow">
        <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
        <feMerge>
          <feMergeNode in="coloredBlur"/>
          <feMergeNode in="SourceGraphic"/>
        </feMerge>
      </filter>
    </defs>

    <!-- Background targeting grid -->
    <g class="grid-layer" opacity="0.2">
      <line x1="200" y1="0" x2="200" y2="300" stroke="#00d9ff" stroke-width="0.5" stroke-dasharray="4,4"/>
      <line x1="0" y1="150" x2="400" y2="150" stroke="#00d9ff" stroke-width="0.5" stroke-dasharray="4,4"/>
      <circle cx="200" cy="150" r="80" fill="none" stroke="#00d9ff" stroke-width="0.5" opacity="0.4"/>
    </g>

    <!-- Raptorial appendage (hammer/dactyl) -->
    <g class="appendage" filter="url(#strike-glow)">
      <!-- Outer shell segments -->
      <path class="segment seg-1" d="M 80,150 L 120,130 L 140,140 L 100,160 Z"
            fill="url(#appendage-gradient)" stroke="#00d9ff" stroke-width="1" opacity="0.6"/>
      <path class="segment seg-2" d="M 120,130 L 160,120 L 180,130 L 140,140 Z"
            fill="url(#appendage-gradient)" stroke="#00d9ff" stroke-width="1" opacity="0.7"/>
      <path class="segment seg-3" d="M 160,120 L 200,115 L 220,125 L 180,130 Z"
            fill="url(#appendage-gradient)" stroke="#00d9ff" stroke-width="1" opacity="0.8"/>

      <!-- Dactyl (hammer section) - layered structure -->
      <ellipse class="dactyl-layer layer-1" cx="250" cy="150" rx="45" ry="35"
               fill="none" stroke="#00d9ff" stroke-width="2" opacity="0.3"/>
      <ellipse class="dactyl-layer layer-2" cx="250" cy="150" rx="38" ry="28"
               fill="none" stroke="#00b4d8" stroke-width="2.5" opacity="0.5"/>
      <ellipse class="dactyl-layer layer-3" cx="250" cy="150" rx="30" ry="22"
               fill="url(#appendage-gradient)" stroke="#00d9ff" stroke-width="3"/>

      <!-- Hammer ridge lines (shows layered structure) -->
      <line x1="220" y1="150" x2="280" y2="150" stroke="#00d9ff" stroke-width="1" opacity="0.6"/>
      <line x1="225" y1="140" x2="275" y2="140" stroke="#00b4d8" stroke-width="0.8" opacity="0.4"/>
      <line x1="225" y1="160" x2="275" y2="160" stroke="#00b4d8" stroke-width="0.8" opacity="0.4"/>

      <!-- Impact point -->
      <circle class="impact-point" cx="285" cy="150" r="6" fill="#00d9ff" opacity="0.9"/>
      <circle class="impact-point" cx="285" cy="150" r="3" fill="#ffffff"/>
    </g>

    <!-- Motion blur trail -->
    <g class="motion-trail" opacity="0">
      <line x1="80" y1="150" x2="285" y2="150" stroke="url(#appendage-gradient)" stroke-width="8" opacity="0.3"/>
      <line x1="100" y1="150" x2="285" y2="150" stroke="url(#appendage-gradient)" stroke-width="12" opacity="0.2"/>
    </g>

    <!-- Impact waves -->
    <g class="impact-waves" opacity="0">
      <circle class="wave wave-1" cx="285" cy="150" r="10" fill="none" stroke="#00d9ff" stroke-width="2"/>
      <circle class="wave wave-2" cx="285" cy="150" r="10" fill="none" stroke="#00b4d8" stroke-width="1.5"/>
      <circle class="wave wave-3" cx="285" cy="150" r="10" fill="none" stroke="#90e0ef" stroke-width="1"/>
    </g>

    <!-- Cavitation bubble effect -->
    <g class="cavitation" opacity="0">
      <circle cx="285" cy="150" r="30" fill="url(#impact-gradient)" opacity="0.6"/>
    </g>

    <!-- Speed indicators -->
    <g class="speed-lines" opacity="0">
      <line x1="50" y1="130" x2="80" y2="130" stroke="#00d9ff" stroke-width="2" opacity="0.6"/>
      <line x1="60" y1="150" x2="80" y2="150" stroke="#00d9ff" stroke-width="3" opacity="0.8"/>
      <line x1="50" y1="170" x2="80" y2="170" stroke="#00d9ff" stroke-width="2" opacity="0.6"/>
    </g>

    <!-- Technical annotations -->
    <g class="annotations" opacity="0.5">
      <text x="250" y="100" fill="#00d9ff" font-size="10" font-family="monospace" text-anchor="middle">DACTYL</text>
      <text x="150" y="190" fill="#00d9ff" font-size="10" font-family="monospace" text-anchor="middle">RAPTORIAL SEGMENTS</text>
      <text x="320" y="155" fill="#00d9ff" font-size="10" font-family="monospace">IMPACT: 10,000G</text>
    </g>
  </svg>

  <div class="stats-overlay">
    <div class="stat-item">
      <span class="stat-value">23 m/s</span>
      <span class="stat-label">Strike Velocity</span>
    </div>
    <div class="stat-item">
      <span class="stat-value">10,000 G</span>
      <span class="stat-label">Acceleration</span>
    </div>
    <div class="stat-item">
      <span class="stat-value">1,500 N</span>
      <span class="stat-label">Impact Force</span>
    </div>
  </div>
</div>

<style>
  .raptorial-container {
    position: relative;
    width: 100%;
    max-width: 600px;
    margin: 0 auto;
  }

  .raptorial-svg {
    width: 100%;
    height: auto;
    display: block;
  }

  /* Strike animation sequence */
  .raptorial-container.animated .appendage {
    animation: strikeSequence 4s ease-in-out infinite;
  }

  @keyframes strikeSequence {
    0%, 100% {
      transform: translateX(0);
    }
    45% {
      transform: translateX(0);
    }
    50% {
      transform: translateX(120px);
    }
    55% {
      transform: translateX(120px);
    }
    60% {
      transform: translateX(0);
    }
  }

  /* Motion trail appears during strike */
  .raptorial-container.animated .motion-trail {
    animation: trailPulse 4s ease-in-out infinite;
  }

  @keyframes trailPulse {
    0%, 45%, 60%, 100% {
      opacity: 0;
    }
    50%, 55% {
      opacity: 1;
    }
  }

  /* Speed lines */
  .raptorial-container.animated .speed-lines {
    animation: speedFlash 4s ease-in-out infinite;
  }

  @keyframes speedFlash {
    0%, 48%, 58%, 100% {
      opacity: 0;
    }
    50%, 56% {
      opacity: 1;
    }
  }

  /* Impact waves expand on strike */
  .raptorial-container.animated .wave {
    animation: impactWave 4s ease-out infinite;
  }

  .wave-1 { animation-delay: 0s; }
  .wave-2 { animation-delay: 0.1s; }
  .wave-3 { animation-delay: 0.2s; }

  @keyframes impactWave {
    0%, 48%, 100% {
      r: 10px;
      opacity: 0;
    }
    50% {
      r: 10px;
      opacity: 1;
    }
    58% {
      r: 50px;
      opacity: 0;
    }
  }

  /* Cavitation bubble */
  .raptorial-container.animated .cavitation {
    animation: cavitationFlash 4s ease-out infinite;
  }

  @keyframes cavitationFlash {
    0%, 48%, 55%, 100% {
      opacity: 0;
    }
    50% {
      opacity: 0.8;
    }
  }

  /* Stats overlay */
  .stats-overlay {
    display: flex;
    justify-content: space-around;
    margin-top: var(--space-md);
    padding: var(--space-md);
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 8px;
  }

  .stat-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.25rem;
  }

  .stat-value {
    font-family: var(--font-mono);
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--color-strike);
  }

  .stat-label {
    font-size: 0.75rem;
    color: var(--color-text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  @media (max-width: 640px) {
    .stats-overlay {
      flex-direction: column;
      gap: var(--space-sm);
    }

    .stat-value {
      font-size: 1rem;
    }
  }
</style>
